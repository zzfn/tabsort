# Chrome 书签智能整理工具

一个基于Python的智能书签整理工具，可以自动将Chrome书签按照主题分类整理。

## 功能特点

- ✅ **AI 智能分类**：支持使用 AI（OpenRouter）进行智能分类
- ✅ **规则分类**：基于域名、URL和关键词的规则分类（可选）
- ✅ **去重处理**：自动删除重复的书签
- ✅ **多层级分类**：支持主分类和子分类
- ✅ **保留元数据**：保留原始书签的图标和时间戳
- ✅ **Chrome兼容**：生成的HTML完全兼容Chrome导入
- ✅ **显示删除记录**：清楚展示哪些重复书签被删除
- ✅ **键盘交互**：使用方向键选择文件和模式，操作更便捷
- ✅ **自动命名**：输出文件按时间戳自动命名，不会覆盖

## 安装

```bash
# 安装依赖
uv add beautifulsoup4 pick openai python-dotenv
```

## 配置（可选 - AI 分类）

如果你想使用 AI 智能分类，需要配置 OpenRouter API：

1. 复制环境变量模板：
```bash
cp .env.example .env
```

2. 编辑 `.env` 文件，填入你的 API Key：
```bash
# OpenRouter API Configuration
OPENROUTER_API_KEY=your_api_key_here
OPENROUTER_MODEL=anthropic/claude-3.5-sonnet

# Classification Mode: 'ai' or 'rules'
CLASSIFICATION_MODE=ai
```

3. 获取 OpenRouter API Key：
   - 访问 [OpenRouter](https://openrouter.ai/)
   - 注册并获取 API Key
   - 支持多种模型（Claude、GPT-4、Gemini 等）

**注意**：如果不配置 API Key，程序会自动使用规则分类模式。

## 使用方法

### 1. 导出Chrome书签

1. 打开Chrome浏览器
2. 按 `Ctrl+Shift+O` (或 `Cmd+Shift+O`) 打开书签管理器
3. 点击右上角的 `...` 菜单
4. 选择 `导出书签`
5. 保存为HTML文件到项目目录

### 2. 运行整理工具

```bash
# 直接运行，会自动列出当前目录的 HTML 文件供选择
uv run python main.py
```

程序会自动：
- 🎯 选择分类模式（AI 或 规则）
- 📋 列出当前目录下所有 HTML 文件（显示大小和修改时间）
- ⌨️ 使用 ↑↓ 方向键选择要整理的文件
- 🕐 按时间戳自动生成输出文件名（如：`20251005_213839.html`）
- 📊 显示详细的分类统计
- 🗑️ 如有重复，显示删除的书签列表
- 💾 保存整理后的书签

**交互示例：**

1. **选择分类模式**（如果配置了 API Key）：
```
🎯 请选择分类模式:

=> 🤖 AI 智能分类 (使用 OpenRouter)
   📏 规则分类 (基于域名和关键词)
```

2. **选择书签文件**：
```
📋 请使用 ↑↓ 方向键选择要整理的书签文件，按 Enter 确认:

=> bookmarks_2025_10_5.html      |   663.2 KB | 2025-10-05 20:55:53
   bookmarks_old.html            |   512.1 KB | 2025-10-01 15:30:21
   bookmarks_backup.html         |   450.8 KB | 2025-09-28 10:15:32
```

3. **AI 分类进度**（如果选择了 AI 模式）：
```
🤖 使用 AI 进行智能分类...
   模型: anthropic/claude-3.5-sonnet
   总计: 660 个书签
   进度: 100/660 (15%)
   进度: 200/660 (30%)
   ...
```

**操作说明：**
- 使用 `↑` `↓` 方向键移动选择
- 按 `Enter` 确认选择
- 按 `Ctrl+C` 取消退出

### 3. 导入整理后的书签

1. 打开Chrome浏览器
2. 按 `Ctrl+Shift+O` (或 `Cmd+Shift+O`) 打开书签管理器
3. 点击右上角的 `...` 菜单
4. 选择 `导入书签`
5. 选择整理后的HTML文件

## 分类模式

### 🤖 AI 智能分类（推荐）

使用大语言模型（如 Claude 3.5 Sonnet）进行智能分类：

**优点：**
- ✅ 更准确：理解内容语义，而非简单匹配
- ✅ 更灵活：自动适应新网站和内容
- ✅ 更智能：可以理解标题和URL的含义
- ✅ 持续优化：随着模型升级自动改进

**缺点：**
- ⚠️ 需要 API Key（OpenRouter 账号）
- ⚠️ 速度稍慢（需要调用 API）
- ⚠️ 有成本（按 token 计费，但很便宜）

**适用场景：**
- 书签内容多样化
- 希望获得最佳分类效果
- 对速度要求不高

### 📏 规则分类（免费）

基于预定义的域名和关键词规则分类：

**优点：**
- ✅ 完全免费：无需 API Key
- ✅ 速度快：本地处理
- ✅ 隐私保护：不发送数据到外部

**缺点：**
- ⚠️ 准确度较低：只能匹配已知规则
- ⚠️ 需要维护：新网站需要手动添加规则
- ⚠️ 灵活性差：无法理解语义

**适用场景：**
- 书签主要是常见网站
- 不想使用 API
- 对隐私有严格要求

## 分类规则

工具会根据以下规则自动分类书签（规则模式）：

- **技术学习**：前端开发、后端开发、数据库、运维/DevOps、代码仓库
  - 独立子文件夹：掘金、V2EX、知乎
- **工作相关**：飞书文档、内部系统
- **设计资源**：UI组件库、图标字体、配色工具
- **资讯媒体**：技术博客、微信公众号
- **工具软件**：在线工具、开发工具
- **投资理财**：行情分析、期权工具
- **学习资源**：算法刷题、技术文档
- **娱乐生活**：影视、音乐
- **AI工具**：AI对话、AI绘图
- **其他**：未能匹配到以上分类的书签

**AI 模式**会自动理解这些分类，无需手动配置规则。

## 自定义分类

编辑 `config.py` 文件可以自定义分类规则：

```python
CATEGORIES = {
    "你的分类": {
        "keywords": ["关键词1", "关键词2"],
        "domains": ["example.com", "example.org"],
        "url_patterns": ["blog", "tutorial"],
        "subcategories": {
            "子分类1": {
                "keywords": ["子关键词"]
            }
        }
    }
}
```

## 重复书签处理

如果发现重复书签，工具会自动删除并显示详细信息：

```
🗑️  已删除的重复书签:
------------------------------------------------------------
   • 书签标题1
     URL: https://example.com/page1

   • 书签标题2
     URL: https://example.com/page2
```

## 项目结构

```
tabsort/
├── main.py              # 主程序入口
├── parser.py            # 书签解析器
├── classifier.py        # 智能分类器
├── organizer.py         # 书签组织器
├── generator.py         # HTML生成器
├── config.py            # 分类配置
└── README.md           # 使用说明
```

## 示例输出

```
============================================================
Chrome 书签智能整理工具
============================================================

📖 正在解析书签文件: bookmarks.html
✅ 解析完成！
   总书签数: 660
   去重后: 660

🤖 正在智能分类...
✅ 分类完成！

📊 分类统计:
------------------------------------------------------------

📁 技术学习 (338 个)
   └─ 前端开发: 119
   └─ 代码仓库: 70
   └─ 后端开发: 23

📁 设计资源 (40 个)
   └─ UI组件库: 16
   └─ 图标字体: 8

... (更多分类)
```

## 注意事项

- 建议先备份原始书签文件
- 首次导入可能需要重启Chrome才能看到所有书签
- 如果分类不准确，可以编辑 `config.py` 调整规则

## License

MIT
